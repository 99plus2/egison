(define $palindrome?
  (lambda [$str]
    (match str string
      {[(loop $i [1 $n]
          <cons $c_i <snoc ,c_i ...>>
          (| <nil> <cons $cm <nil>>))
        [c cm]]
       [_ #f]})))

(test (palindrome? "しんぶんし"))
